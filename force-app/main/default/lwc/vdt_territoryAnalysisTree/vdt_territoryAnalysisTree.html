<template>
    <div class="container" style="position:relative">
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading" size="large"></lightning-spinner>
        </template>
        <lightning-layout multiple-rows>
            <lightning-layout-item size="12">
                <lightning-layout>
                    <lightning-layout-item size="2">
                        <lightning-input 
                            type="toggle" 
                            label="Include Child Territories" 
                            message-toggle-active=""
                            message-toggle-inactive=""
                            onchange={handleChangeFullSeach}>
                        </lightning-input>
                    </lightning-layout-item>
                </lightning-layout>            
            </lightning-layout-item>
            <lightning-layout-item size="12">
                <lightning-layout>
                    <lightning-layout-item size="2">
                        <lightning-input 
                            type="text" 
                            variant="label-hidden"
                            name="field" 
                            placeholder="Find Territory"
                            onchange={handleTerritoryFilterInputChange}
                        ></lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="2" class="filter-component">
                        <c-vdt_autocomplete-input
                            placeholder="Select Metric to Filter"
                            options={metricOptions}
                            onoptionselect={handleMetricOptionSelect}
                        ></c-vdt_autocomplete-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="2" class="filter-component">
                        <c-vdt_autocomplete-input
                            placeholder="Operator"
                            options={operators}
                            onoptionselect={handleOperatorOptionSelect}
                        ></c-vdt_autocomplete-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="2" class="filter-component">
                        <lightning-input type="number" 
                            variant="label-hidden"
                            placeholder="Enter a number"
                            onchange={handleAmountChange}>
                        </lightning-input>
                    </lightning-layout-item>
                    <lightning-layout-item size="2" class="filter-component">
                        <c-vdt_autocomplete-input
                            placeholder="Account Type"
                            options={accountTypeOptions}
                            onoptionselect={handleAccountTypeOptionSelect}
                        ></c-vdt_autocomplete-input>
                    </lightning-layout-item>                    
                    <lightning-layout-item alignment-bump="left" style="position:relative">
                        <template if:true={isExportLoading}>
                            <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                        </template>
                        <lightning-button
                            variant="brand"
                            name="export_csv"
                            label='Export CSV'
                            onclick={handleExportCSV}
                        ></lightning-button>
                    </lightning-layout-item>
                </lightning-layout>
            </lightning-layout-item>
            <lightning-layout-item>
                <lightning-tree items={treeItems} header="Territories" onselect={handleOnTerritoryselect} selected-item={selectedItem}></lightning-tree>
            </lightning-layout-item>
            <lightning-layout-item size="12" class="graphs">
                <lightning-datatable
                    columns={tableColumns}
                    data={_currentPageData}
                    key-field="id"
                    hide-checkbox-column
                ></lightning-datatable>
            </lightning-layout-item>            
            <lightning-layout-item size="12" class="paginator">
                <c-vdt_paginator
                    page-numbers={pageNumbers}
                    current-page={currentPageNumber}
                    onprevious={handlePreviousClick}
                    onpageclick={handlePageClick}
                    onnext={handleNextClick}
                ></c-vdt_paginator>
            </lightning-layout-item>
        </lightning-layout>
    </div>
</template>